# AI Compass 项目完善与重构计划 (V2)

根据 Nuxt Content 文档规范、MCP (模块化组件模式) 及 **迭代式开发流程规范**，制定以下实施计划。

## 0. 开发流程规范 (Development Process)

### 0.1 开发阶段要求
- **模块化开发**: 将项目拆分为高内聚、低耦合的大模块，每个模块包含完整的前后端交互与 UI。
- **里程碑确认**: 每个模块开发完成后暂停，提交测试报告，等待确认后进入下一阶段。
- **独立测试**: 模块间保持松耦合，确保可独立进行单元测试与功能验证。

### 0.2 质量保证措施 (QA)
- **单元测试**: 核心逻辑覆盖率 ≥ 80% (使用 Vitest)。
- **接口文档**: 提供 API 定义与使用说明 (Markdown/TSDoc)。
- **交付清单**: 每次提交包含功能清单、已知问题、部署/环境依赖说明。

### 0.3 版本控制 (Git Flow)
- **分支策略**:
  - `main`: 生产分支 (Stable)。
  - `develop`: 开发主分支。
  - `feature/module-name`: 模块开发分支。
- **合并标准**: 通过自动化测试与代码审查后合并至 `develop`。

---

## 1. 模块划分与实施计划

### 📦 模块一：架构重构与基础设施 (Architecture & Infra)
**目标**: 建立符合 MCP 的目录结构，统一 API 层，配置混合渲染与测试环境。

- **任务清单**:
  - [ ] **目录重构**: 按 MCP 模式重组 `app/` (Components, Composables)。
  - [ ] **API 层封装**: 实现 `useApi`，统一 Supabase/Content 请求与错误处理。
  - [ ] **混合渲染配置**: 在 `nuxt.config.ts` 中实现 SWR/ISG/SPA 混合策略。
  - [ ] **测试环境搭建**: 集成 Vitest，编写 `useApi` 与 Store 的单元测试。
  - [ ] **Git 初始化**: 建立仓库，创建 `develop` 分支。

- **交付物**:
  - 重构后的代码库。
  - 单元测试报告 (覆盖率截图)。
  - `docs/API_LAYER.md` (API 层使用文档)。

### 📦 模块二：前台核心业务 (Public Domain)
**目标**: 完善面向用户的核心功能（展示、搜索、内容），实现响应式 UI。

- **任务清单**:
  - [ ] **组件模块化**: 拆分 `ToolCard`, `SearchBar`, `MarkdownView` 等组件。
  - [ ] **搜索增强**: 优化 `search.vue`，集成服务端过滤与本地历史。
  - [ ] **内容集成**: 规范化 Nuxt Content 文章展示与 Markdown 渲染。
  - [ ] **UI 响应式**: 确保 PC/Pad/Mobile 三端适配。

- **交付物**:
  - 完整的首页、列表页、详情页、搜索页。
  - 关键组件的快照测试/单元测试。

### 📦 模块三：用户与交互系统 (User System)
**目标**: 实现用户收藏、评分等交互功能（基于本地存储或 Supabase）。

- **任务清单**:
  - [ ] **用户状态管理**: 完善 `userStore` (Pinia)。
  - [ ] **收藏功能**: 实现收藏/取消收藏逻辑与持久化。
  - [ ] **评分组件**: 交互式评分 UI 组件。

- **交付物**:
  - 交互功能完整的用户系统。
  - Store 逻辑单元测试。

### 📦 模块四：后台管理系统 (Admin System)
**目标**: 实现数据的增删改查 (CRUD) 与管理界面。

- **任务清单**:
  - [ ] **管理布局**: 独立的 Admin Layout 与侧边栏。
  - [ ] **工具管理**: 工具列表、新增/编辑表单 (Schema Validation)。
  - [ ] **权限控制**: 基础的路由守卫 (Route Guard)。

- **交付物**:
  - 可运行的后台管理系统。
  - CRUD 操作的测试用例。

---

## 2. 立即执行：模块一启动准备

如果您确认以上计划无误，我将开始 **模块一：架构重构与基础设施** 的开发。
1. 初始化 Git 仓库并切出 `feature/architecture-refactor` 分支。
2. 执行目录重构与环境配置。
3. 编写基础测试。
